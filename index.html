<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ez Blinds Quotee v0.3 - Spreadsheet Mode</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app" class="app-container">
        <div class="results-panel">
            <!-- Thead is now dynamically generated by TableComponent -->
            <table class="results-table" id="results-table">
                <tbody></tbody>
            </table>
        </div>
        <div class="keyboard-panel" id="numeric-keyboard-panel">
            <div class="panel-toggle" id="panel-toggle" title="Toggle Keyboard">
                <svg class="toggle-arrow arrow-down" xmlns="http://www.w.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" /></svg>
                <svg class="toggle-arrow arrow-up" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" /></svg>
            </div>
            
            <div class="top-summary-container" id="top-summary-container">
                <span class="label">SUM</span>
                <span class="value is-current" id="total-sum-value"></span>
            </div>

            <div class="virtual-keyboard" id="numeric-keyboard">
                <button id="key-7">7</button>
                <button id="key-8">8</button>
                <button id="key-9">9</button>
                <button id="key-w">W</button>
                <button id="key-type">Type</button>

                <button id="key-4">4</button>
                <button id="key-5">5</button>
                <button id="key-6">6</button>
                <button id="key-h">H</button>
                <button id="key-price">$</button>

                <button id="key-1">1</button>
                <button id="key-2">2</button>
                <button id="key-3">3</button>
                <button id="key-enter">&#x23CE;</button>
                
                <button id="key-0">0</button>
                <button id="key-del">&#x2B05;</button>
                <button id="key-clear">C</button>
            </div>
        </div>
    </div>

    <div id="left-panel">
        <div id="left-panel-toggle" title="Toggle Left Panel">
             <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 20px; height: 20px;">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
            </svg>
        </div>
        <div class="tab-container">
            <button id="k1-tab" class="tab-button active" data-tab-target="#k1-content">K1</button>
            <button id="k2-tab" class="tab-button" data-tab-target="#k2-content">K2</button>
            <button id="k3-tab" class="tab-button" data-tab-target="#k3-content">K3</button>
            <button id="k4-tab" class="tab-button" data-tab-target="#k4-content">K4</button>
            <button id="k5-tab" class="tab-button" data-tab-target="#k5-content">K5</button>
        </div>
        <div class="tab-content-container">
            <div id="k1-content" class="tab-content active">
                <div class="feature-grid">
                    <div class="feature-group">
                        <div class="feature-buttons">
                            <button id="btn-focus-location" class="feature-button">#Location</button>
                            <button id="btn-focus-fabric" class="feature-button">#Fabric & Color</button>
                        </div>
                    </div>
                    <div class="feature-group">
                        <table class="panel-input-table" id="fabric-batch-table">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>F-Name</th>
                                    <th>F-Color</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>BO</td>
                                    <td><input type="text" data-type="BO" data-field="fabric" class="panel-input"></td>
                                    <td><input type="text" data-type="BO" data-field="color" class="panel-input"></td>
                                </tr>
                                <tr>
                                    <td>BO1</td>
                                    <td><input type="text" data-type="BO1" data-field="fabric" class="panel-input"></td>
                                    <td><input type="text" data-type="BO1" data-field="color" class="panel-input"></td>
                                </tr>
                                <tr>
                                    <td>SN</td>
                                    <td><input type="text" data-type="SN" data-field="fabric" class="panel-input"></td>
                                    <td><input type="text" data-type="SN" data-field="color" class="panel-input"></td>
                                </tr>
                                <tr>
                                    <td>LF</td>
                                    <td><input type="text" data-type="LF" data-field="fabric" class="panel-input" disabled></td>
                                    <td><input type="text" data-type="LF" data-field="color" class="panel-input" disabled></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div id="k2-content" class="tab-content">
                <div class="feature-grid">
                    <div class="feature-group">
                        <label class="feature-label">Focus & Batch: OVER (正反捲)</label>
                        <div class="feature-buttons">
                            <button id="btn-focus-over" class="feature-button">#OVER</button>
                            <button id="btn-batch-over-o" class="feature-button batch-button">全部設為 O</button>
                            <button id="btn-batch-over-normal" class="feature-button batch-button">全部設為 Normal</button>
                        </div>
                    </div>
                    <div class="feature-group">
                        <label class="feature-label">Focus & Batch: O/I (內外裝)</label>
                        <div class="feature-buttons">
                            <button id="btn-focus-oi" class="feature-button">#O/I</button>
                            <button id="btn-batch-oi-in" class="feature-button batch-button">全部設為 IN</button>
                            <button id="btn-batch-oi-out" class="feature-button batch-button">全部設為 OUT</button>
                        </div>
                    </div>
                    <div class="feature-group">
                        <label class="feature-label">Focus & Batch: L/R (左右拉繩)</label>
                        <div class="feature-buttons">
                            <button id="btn-focus-lr" class="feature-button">#L/R</button>
                            <button id="btn-batch-lr-l" class="feature-button batch-button">全部設為 L</button>
                            <button id="btn-batch-lr-r" class="feature-button batch-button">全部設為 R</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="k3-content" class="tab-content">(K3) 功能留空</div>
            <div id="k4-content" class="tab-content">(K4) 功能留空</div>
            <div id="k5-content" class="tab-content">
                <div class="feature-grid">
                    <div class="feature-group">
                        <div class="feature-buttons">
                             <button id="btn-return-form1" class="feature-button">Form1</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="function-panel">
        <div id="function-panel-toggle" title="Toggle Function Panel">
            <svg class="toggle-arrow arrow-left" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" /></svg>
            <svg class="toggle-arrow arrow-right" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" /></svg>
        </div>
        <div class="function-grid">
            <button id="key-insert">Insert</button>
            <button id="key-f3" disabled>F3</button>
            <button id="key-save">Save</button>
            <button id="key-f1" disabled>F1</button>
            <button id="key-f2" disabled>F2</button>
            <button id="key-load">Load</button>
            <button id="key-delete">Delete</button>
            <button id="key-f4" disabled>F4</button>
            <button id="key-export">Export</button>
            <button id="key-f5">M-Del</button>
            <button id="key-f6" disabled>F6</button>
            <button id="key-reset">RESET</button>
        </div>
    </div>

    <input type="file" id="file-loader" style="display: none;" accept=".json,.csv">
    <div id="toast-container"></div>

    <div id="confirmation-dialog-overlay" class="dialog-overlay is-hidden">
        <div class="dialog-box">
            <p class="dialog-message">The current quote contains unsaved data. What would you like to do?</p>
            <div class="dialog-buttons">
                <button id="dialog-btn-save-load" class="dialog-button">Save then Load</button>
                <button id="dialog-btn-load" class="dialog-button">Load Directly</button>
                <button id="dialog-btn-cancel" class="dialog-button secondary">Cancel</button>
            </div>
        </div>
    </div>

    <script type="module" src="./04-core-code/main.js"></script>
</body>
</html>